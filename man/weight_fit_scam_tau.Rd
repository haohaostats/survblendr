% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/weight_scam_tau.R
\name{weight_fit_scam_tau}
\alias{weight_fit_scam_tau}
\title{Monotone spline weight with temperature calibration (SCAM + logistic)}
\usage{
weight_fit_scam_tau(
  times,
  S_obs,
  S_ext,
  J = 10,
  tau_step = 1.5,
  tau_max = 1e+06
)
}
\arguments{
\item{times}{Numeric grid (strictly increasing).}

\item{S_obs}{Numeric mean observed-side survival on \code{times}.}

\item{S_ext}{Numeric mean external-side survival on \code{times}.}

\item{J}{Basis dimension for \code{s(..., bs="mpi")}. Default 10.}

\item{tau_step}{Multiplicative step for temperature. Default 1.5.}

\item{tau_max}{Max temperature. Default 1e6.}
}
\value{
List with \code{pi} (weights), \code{dpi}, \code{tau}, \code{eta},
\code{hmin} (min blended hazard), and \code{ok}.
}
\description{
Fits a monotone increasing P-spline (via \pkg{scam}, \code{bs="mpi"}) to
z(t) = log H_obs(t) - log H_ext(t), then maps to w(t) = logit^{-1}{eta(t)/tau}.
The temperature tau is increased multiplicatively until the blended hazard
h_blend = (1-w) h_obs + w h_ext + (H_ext - H_obs) * w'(t) is nonnegative on the grid.
}
